/* jshint ignore:start */
var inclusionsBegin,inclusionsEnd;!function(extensions,isNode){!function loadExtensions(e){"function"==typeof Object.polyfill?("boot"===e||isNode||window.removeEventListener("polyfills",loadExtensions),Object.env.verbose&&console.log("loading extensions"),extensions(Object.polyfill),String.extensionsTest(Object.env.verbose),console.log("self tests passed"),isNode||window.dispatchEvent(new CustomEvent("extensions",{file:"extensions.js"}))):"boot"!==e||isNode||(Object.env.verbose&&console.log("waiting for polyfills..."),window.addEventListener("polyfills",loadExtensions))}("boot")}(function(extend){var jsClass=Object.jsClass,isString=jsClass.getTest(""),cpArgs=Function.args;function isEmpty(x){return 0<=[null,void 0].indexOf(x)||0===x.length||x.constructor===Object&&0===Object.keys(x).length}function stringifyPathNode(n){if(n.charAt(0)+n.charAt(n.length-1)!=='""')return"["+n+"]";n=n.replace(/\./g,"\\u002E").replace(/\\"/g,"\\u0022");var s,n2=(s=n).substr(1,s.length-2);return n2.split("").some(function(c,ix){return!("A"<=c&&c<="Z")&&(!("a"<=c&&c<="z")&&("0"<=c&&c<=9?0===ix:"_$".indexOf(c)<0))})?"["+n+"]":"."+n2}function stringifyPathArray(p){return p.map(JSON.stringify).map(stringifyPathNode).join("")}function parsePathString(p){var arr=[];return p.split("[").forEach(function(chunk){chunk.split("]").forEach(function(chunk){arr.push.apply(arr,chunk.split("."))})}),arr=arr.filter(function(chunk){return""!==chunk}).map(function(chunk){if('"'===chunk.charAt(0))return JSON.parse(chunk);var num=Number.parseInt(chunk);return isNaN(chunk)?chunk:num})}extend(Object,function(object){object("isEmpty",isEmpty),object("keyCount",function(o){if(o!==Object(o))throw new TypeError("Object.keyCount called on a non-object");var p,c=0,isKey=Object.prototype.hasOwnProperty.bind(o);for(p in o)isKey(p)&&c++;return c}),object("removeKey",function(obj,k){var res=obj[k];if(void 0!==res)return delete obj[k],res}),object("replaceKey",function(obj,k,v){var res=obj[k];return obj[k]=v,res}),object("removeAllKeys",function(obj){var res=Object.keys(obj);return res.forEach(function(k){delete obj[k]}),res}),object("mergeKeys",function(obj1,obj2,keys,keep){return(keys=keys||Object.keys(obj2)).forEach(function(k){keep&&void 0!==obj1[k]||(obj1[k]=obj2[k])}),obj1}),object("subtractKeys",function(obj,keys,isObject){var res={};return(keys=isObject?Object.keys(keys):keys).forEach(function(k){obj[k]&&(res[k]=obj[k],delete obj[k])}),res}),object("iterateKeys",function(obj,fn){Object.keys(obj).some(function(k,i,ks){try{return fn(k,obj[k],i,ks),!1}catch(e){return!0}})});function iterator(o,cb,k,i,ks){var v=o[k];return cb.apply(o,[k,v,i,ks,o,typeof v])}function iterator2(o,cb,k,i,ks){var v=o[k];return cb.apply(o,[{key:k,value:v,index:i,keys:ks,obj:o,type:typeof v}])}object("keyLoop",function(obj,cb,m){return Object.keys(obj).forEach((m?iterator2:iterator).bind(obj,obj,cb))}),object("keyMap",function(obj,cb,m){return Object.keys(obj).map((m?iterator2:iterator).bind(obj,obj,cb))}),object("keyFilter",function(obj,cb,m){var r={},o=obj;return Object.keys(o).filter((m?iterator2:iterator).bind(o,o,cb)).forEach(function(k){r[k]=o[k]}),r});var ab_now=function(){if(Object.env.isNode){var perf_hooks=require("perf_hooks");return perf_hooks.performance.now.bind(perf_hooks.performance)}return"object"==typeof performance&&"function"==typeof performance.now?performance.now.bind(performance):Date.now.bind(Date)}();Object.a_b_test_logging=!1,object("a_b_test",function(obj,fn,trials,loops,mode){if(arguments.length<6)return!1;if("string"!=typeof fn)return!1;if(["number","undefined"].indexOf(typeof trials)<0)return!1;if(["number","undefined"].indexOf(typeof loops)<0)return!1;var THIS=!1,logging=Object.a_b_test_logging;if("object"==typeof obj)switch(mode){case!1:case!0:THIS=void 0;break;default:if(["function","undefined"].indexOf(typeof mode)<0){THIS=mode;break}obj.constructor===mode&&"function"==typeof mode&&(THIS=void 0)}if(!1===THIS)return!1;var config=Object.getOwnPropertyDescriptor(obj,fn);if(!config)return!1;if(!config.writable||!config.configurable)return!1;var native=obj[fn];if("function"!=typeof native)return!1;trials=trials||100,loops=loops||1;var fns=cpArgs(arguments).slice(5);if(fns.some(function(fn){return"function"!=typeof fn}))return!1;fns.push(native);function next_trial(){trials<=++count&&function(){for(var best=1/0,best_ix=-1,i=0;i<ab_count;i++)totals[i]<best&&(best=totals[i],best_ix=i);var average=totals[best_ix]/count;logging&&(console.log(totals.map(function(total,ix){return{name:fns[ix].name,total:Number(total.toFixed(3)),per_trial:Number((total/count).toFixed(3)),per_invoke:Number((total/(count*loops)).toFixed(4))}})),fns[best_ix]===native?console.log("reverting to native mode for",fn,"after",count,"tests",average,"average msec"):console.log("selected mode",String.fromCharCode(97+best_ix),"for",fn,"after",count,"tests",average,"average msec"));config.value=fns[best_ix],delete obj[fn],Object.defineProperty(obj,fn,config)}()}function next(inc){ab_count<=++a_b&&(a_b=0),inc&&next_trial()}var count=0,a_b=0,totals=fns.map(function(){return 0}),ab_count=fns.length,names=fns.map(function(x){return x.name}).join(",");config.value=logging?function(){var result,start,start_,finish,elapsed,compare,this_=THIS||this,do_loops=loops,args=cpArgs(arguments),err=1!==loops&&new Error("inconsistent results");try{if(start=ab_now(),result=fns[a_b].apply(this_,args),elapsed=(finish=ab_now())-start,totals[a_b]+=elapsed,1===do_loops)console.log("trial #"+count+": invoked",fns[a_b].name,args.length,"args returning",result,"took",elapsed.toFixed(3),"msec"),next(!0);else{for(start_=start,next(!1);0<--do_loops;){if(start=ab_now(),compare=fns[a_b].apply(this_,args),finish=ab_now(),result!==compare)throw err;elapsed=finish-start,totals[a_b]+=elapsed,next(!1)}elapsed=finish-start_,console.log("trial #"+count+": invoked",names,"(",args.length,"args)",loops,"times, returning",result,"took",elapsed.toFixed(3),"msec (",(elapsed/loops).toFixed(3),"msec per invoke)"),next_trial()}}catch(e){if(fns[a_b]!==native)return(obj[fn]=native).apply(this_,args);throw e}return result}:function(){var result,start,start_,finish,elapsed,compare,this_=THIS||this,do_loops=loops,args=cpArgs(arguments),err=1!==loops&&new Error("inconsistent results");try{if(start=ab_now(),result=fns[a_b].apply(this_,args),elapsed=(finish=ab_now())-start,totals[a_b]+=elapsed,1===do_loops)next(!0);else{for(start_=start,next(!1);0<--do_loops;){if(start=ab_now(),compare=fns[a_b].apply(this_,args),finish=ab_now(),result!==compare)throw err;elapsed=finish-start,totals[a_b]+=elapsed,next(!1)}elapsed=finish-start_,next_trial()}}catch(e){if(fns[a_b]!==native)return(obj[fn]=native).apply(this_,args);throw e}return result},delete obj[fn],Object.defineProperty(obj,fn,config)}),object("a_b_test_async",function(obj,fn,trials,mode){if(arguments.length<5)return!1;if("string"!=typeof fn)return!1;if(["number","undefined"].indexOf(typeof trials)<0)return!1;if(["number","undefined"].indexOf(typeof loops)<0)return!1;var THIS=!1,logging=Object.a_b_test_logging;if("object"==typeof obj)switch(mode){case!1:case!0:THIS=void 0;break;default:if(["function","undefined"].indexOf(typeof mode)<0){THIS=mode;break}obj.constructor===mode&&"function"==typeof mode&&(THIS=void 0)}if(!1===THIS)return!1;var config=Object.getOwnPropertyDescriptor(obj,fn);if(!config)return!1;if(!config.writable||!config.configurable)return!1;var native=obj[fn];if("function"!=typeof native)return!1;trials=trials||100;var fns=cpArgs(arguments).slice(4);if(fns.some(function(fn){return"function"!=typeof fn}))return!1;fns.push(native);function next_trial(){trials<=++count&&function(){for(var best=1/0,best_ix=-1,i=0;i<ab_count;i++)totals[i]<best&&(best=totals[i],best_ix=i);var average=totals[best_ix]/count;logging&&(console.log(totals.map(function(total,ix){return{name:fns[ix].name,total:Number(total.toFixed(3)),per_invoke:Number((total/count).toFixed(3))}})),fns[best_ix]===native?console.log("reverting to native mode for",fn,"after",count,"tests",average,"average msec"):console.log("selected mode",String.fromCharCode(97+best_ix),"for",fn,"after",count,"tests",average,"average msec"));config.value=fns[best_ix],delete obj[fn],Object.defineProperty(obj,fn,config)}()}var count=0,a_b=0,totals=fns.map(function(){return 0}),ab_count=fns.length,next=function(inc){ab_count<=++a_b&&(a_b=0),inc&&next_trial()};fns.map(function(x){return x.name}).join(",");config.value=logging?function(){var start,finish,elapsed,this_=THIS||this,args=cpArgs(arguments),cb=0<args.length&&"function"==typeof args[args.length-1]&&args[args.length-1];return cb?(args[args.length-1]=function(){finish=ab_now(),elapsed=finish-start,totals[a_b]+=elapsed,console.log("trial #"+count+": invoked",fns[a_b].name,args.length,"args returning",void 0,"took",elapsed.toFixed(3),"msec"),next(!0),cb.apply(this_,cpArgs(arguments))},start=ab_now(),fns[a_b].apply(this_,args)):function(args,this_){var result,start,elapsed;try{start=ab_now(),result=fns[a_b].apply(this_,args),elapsed=ab_now()-start,totals[a_b]+=elapsed,console.log("trial #"+count+": invoked",fns[a_b].name,args.length,"args returning",result,"took",elapsed.toFixed(3),"msec"),next(!0)}catch(e){if(fns[a_b]!==native)return(obj[fn]=native).apply(this_,args);throw e}return result}(args,this_)}:function(){var start,finish,elapsed,this_=THIS||this,args=cpArgs(arguments),cb=0<args.length&&"function"==typeof args[args.length-1]&&args[args.length-1];return cb?(args[args.length-1]=function(){finish=ab_now(),elapsed=finish-start,totals[a_b]+=elapsed,next(!0),cb.apply(this_,cpArgs(arguments))},start=ab_now(),fns[a_b].apply(this_,args)):function(args,this_){var result,start,elapsed;try{start=ab_now(),result=fns[a_b].apply(this_,args),elapsed=ab_now()-start,totals[a_b]+=elapsed,next(!0)}catch(e){if(fns[a_b]!==native)return(obj[fn]=native).apply(this_,args);throw e}return result}(args,this_)},delete obj[fn],Object.defineProperty(obj,fn,config)}),object("a_b_test_tester",function(loops,quick){loops=loops||1;var logging_backup=Object.a_b_test_logging;Object.a_b_test_logging=!0;var String_prototype_indexOf=String.prototype.indexOf,sample=quick?"the quick brown fox jumps over the lazy dog":require("fs").readFileSync("./words.txt","utf8"),indexOfC_lookups=function(sep){var d={},c=0;console.log("preparing lookups...");for(var r,k,sampleSet=sample.split(sep),max=Math.min(25e3,sampleSet.length);c<max;)(k=sampleSet[r=Math.floor(Math.random()*sampleSet.length)])&&(sampleSet[r]=null,d[k=k.trim()]=sample.indexOf(k),++c%500==0&&(sampleSet=sampleSet.filter(function(x){return null!==x}),console.log("added",c,"random words, just added  [",k.padStart(20),"]",(c/(max/100)).toFixed(1),"% complete")));var keys=Object.keys(d),first=keys.shift(),last=keys.pop();return keys.splice(0,keys.length),console.log("prepared",c,"lookups",first,"thru",last),d}(quick?" ":"\n");function indexOf_a(str){for(var c=this.length,l=str.length,i=0;i<c;i++)if(this.substr(i,l)===str)return i;return-1}function indexOf_b(str){for(var c=this.length,i=(str.length,0);i<c;i++)if(this.substr(i).startsWith(str))return i;return-1}function indexOf_c(str){var x=indexOfC_lookups[str];return void 0===x&&(x=String_prototype_indexOf.call(this,str)),x}Object.a_b_test(String.prototype,"indexOf",10,loops,String,indexOf_a,indexOf_b,indexOf_c);for(var i=0;i<10;i++)sample.indexOf("fox"),sample.indexOf("jumps"),sample.indexOf("notFound"),sample.indexOf("abacinate"),sample.indexOf("dog"),sample.indexOf("lazy"),sample.indexOf("quick"),sample.indexOf("zebra"),sample.indexOf("the");var tester={test:function(a,b){return a.indexOf(b)}};for(Object.a_b_test(tester,"test",10,loops,!1,function(a,b){return indexOf_a.call(a,b)},function(a,b){return indexOf_b.call(a,b)},function(a,b){return indexOf_c.call(a,b)}),i=0;i<10;i++)tester.test(sample,"fox"),tester.test(sample,"jumps"),tester.test(sample,"notFound"),tester.test(sample,"abacinate"),tester.test(sample,"dog"),tester.test(sample,"lazy"),tester.test(sample,"quick"),tester.test(sample,"zebra"),tester.test(sample,"the");var tester2={test:sample.indexOf};for(Object.a_b_test(tester2,"test",10,loops,sample,indexOf_a,indexOf_b,indexOf_c),i=0;i<10;i++)tester2.test("fox"),tester2.test("jumps"),tester2.test("notFound"),tester2.test("abacinate"),tester2.test("dog"),tester2.test("lazy"),tester2.test("quick"),tester2.test("zebra"),tester2.test("the");var tester3={data:sample};for(Object.defineProperties(tester3,{test:{value:function(str){return this.data.indexOf(str)},configurable:!0,writable:!0},test_a:{value:function(str){return indexOf_a.call(this.data,str)}},test_b:{value:function(str){return indexOf_b.call(this.data,str)}},test_c:{value:function(str){return indexOf_c.call(this.data,str)}}}),Object.a_b_test(tester3,"test",10,loops,!0,tester3.test_a,tester3.test_b,tester3.test_c),i=0;i<10;i++)tester3.test("fox"),tester3.test("jumps"),tester3.test("notFound"),tester3.test("abacinate"),tester3.test("dog"),tester3.test("lazy"),tester3.test("quick"),tester3.test("zebra"),tester3.test("the");Object.a_b_test_logging=logging_backup}),object("a_b_test_async_tester",function(trials){trials=trials||10;var logging_backup=Object.a_b_test_logging;Object.a_b_test_logging=!0;var fs=require("fs"),readFileNative=fs.readFile.bind(fs);function readFile_a(){var delay=Math.floor(100+900*Math.random()),args=[readFileNative,delay].concat(cpArgs(arguments));return setTimeout.apply(global,args)}var count=trials+10;function afterRead(err,data){console.log({afterRead:{err:err,data:typeof data,length:data?data.length:void 0,count:count}}),!err&&0<data.indexOf("fs.readFile")?0<count--?(console.log("looping"),fs.readFile(__filename,"utf8",afterRead)):Object.a_b_test_logging=logging_backup:console.log("???")}fs.readFile(__filename,"utf8",function(err,data){console.log({err:err,data:typeof data,length:data?data.length:void 0}),!err&&0<data.indexOf("fs.readFile")&&(console.log("native fs.readFile looks ok"),readFile_a(__filename,"utf8",function(err,data){console.log({readFile_a:{err:err,data:typeof data,length:data?data.length:void 0}}),!err&&0<data.indexOf("fs.readFile")&&(console.log("delayed fs.readFile stub looks ok"),Object.a_b_test_async(fs,"readFile",trials,!0,readFile_a.bind(fs)),fs.readFile(__filename,"utf8",afterRead))}))})})}),extend(Array,function(array){array.prototype("remove",function(o){for(var ix;0<=(ix=this.indexOf(o));)this.splice(ix,1)}),array.prototype("contains",function(o){return 0<=this.lastIndexOf(o)}),array.prototype("add",function(o){this.indexOf(o)<0&&this.push(o)}),array.prototype("toggle",function(o){var ix,result=(ix=this.indexOf(o))<0;if(result)this.push(o);else for(;0<=ix;)this.splice(ix,1),ix=this.indexOf(o);return result}),array.prototype("replace",function(oldValue,newValue){if(oldValue&&oldValue!==newValue)for(var ix;0<=(ix=this.indexOf(oldValue));)this.splice(ix,1,newValue)}),array.prototype("item",function(ix){return this[ix]}),array("flattenArray",function(input,fn_bind_context,minArgs){function getValues(x,ix){switch(jsClass(x)){case"String":case"RegExp":return output.push(x);case"Array":return has_objects=!0,output.push.apply(output,x);case"Object":return has_objects=!0,output.push.apply(output,Object.values(x));case"Number":return output.push(x.toString());case"Function":if(fn_bind_context&&(1===x.length||x.length>=(minArgs||1))&&0<=Object.keys(x).length){var bound_fns=[];return Object.keys(x).forEach(function(k){Array.flattenArray(x[k],fn_bind_context,minArgs).forEach(function(term,term_ix){var fn_x=1===x.length?x(term):x.bind(fn_bind_context,term);Object.defineProperties(fn_x,{name:{value:("fn "+x.name+" "+k+" "+term+" "+(0===term_ix?"":" "+term_ix.toString(36))).split(" ").map(function(camel,ix){return 0===ix?camel.toLowerCase():camel.charAt(0).toUpperCase()+camel.substr(1).toLowerCase()}).join("")}}),bound_fns.push(fn_x)})}),output.push.apply(output,bound_fns)}return output.push(x)}}var output=[],has_objects=!1;for(getValues(input);has_objects;)input=output,has_objects=!(output=[]),input.forEach(getValues);return output}),array("flattenArrayWithPaths",function(input){var save_dir,output=[],paths=[],dir=[],getValues=function(x,ix){var here=void 0===ix?[]:[ix];switch(jsClass(x)){case"String":case"RegExp":return paths.push(dir.concat(here)),output.push(x);case"Array":return dir=(save_dir=dir).concat(here),x.forEach(getValues),void(dir=save_dir);case"Object":return dir=(save_dir=dir).concat(here),Object.keys(x).forEach(function(key){return getValues(x[key],key)}),void(dir=save_dir);case"Number":return paths.push(dir.concat(here)),output.push(x.toString())}};return getValues(input),{arr:output,paths:paths.map(stringifyPathArray)}}),array("followArrayPath",function(arr,path){return parsePathString(path).some(function(p){return!(arr=arr[p])}),arr}),array("setArrayPath",function(arr,path,value){return parsePathString(path).some(function(p,ix,keys){if(arr[p]){if(ix+1===keys.length)return arr[p]=value,!0}else{if(!(ix+1<keys.length))return arr[p]=value,!0;"string"==typeof keys[ix+1]?arr[p]={}:arr[p]=[]}return arr=arr[p],!1}),arr}),array.prototype("atPath",function(path){return Array.followArrayPath(this,path)}),array("proxifyArray",function(wrapped,console){wrapped="object"==typeof wrapped&&wrapped.constructor===Array?wrapped:"string"==typeof wrapped&&2<wrapped.length&&"["===wrapped.charAt(0)&&"]"===wrapped.substr(-1)?JSON.parse(wrapped):[];var sysConsole=console||{log:function(){}};console=sysConsole;function event_cmd(fn){event_props[fn.name]={value:fn,enumerable:!1,configurable:!0}}var events={push:[],pop:[],shift:[],unshift:[],splice:[]},event_props={};event_cmd(function(){console={log:function(){}}}),event_cmd(function(con){console=con||sysConsole}),event_cmd(function(ev,fn){"function"==typeof fn&&"object"==typeof events[ev]&&events[ev].indexOf(fn)<0&&events[ev].push(fn)}),event_cmd(function(ev,fn){if("function"==typeof fn&&"object"==typeof events[ev]){var ix=events[ev].indexOf(fn);0<=ix&&(console.log("removing event",ev),events[ev].splice(ix,1))}else"all"===fn&&"object"==typeof events[ev]?(console.log("removing",events[ev].length,"events from",ev),events[ev].splice(0,events[ev].length)):"all"===ev&&void 0===fn&&Object.keys(events).forEach(function(ev){console.log("removing",events[ev].length,"events from",ev),events[ev].splice(0,events[ev].length)})});var hookEventProp,wrapped_props,handlers={},original_props={hook:{value:function(){return delete wrapped.hook,delete wrapped.unhook,Object.defineProperties(wrapped,wrapped_props),wrapped},enumerable:!1,configurable:!0},unhook:{value:function(){return wrapped},enumerable:!1,configurable:!0}};wrapped_props={hook:{value:function(){return wrapped},enumerable:!1,configurable:!0},unhook:{value:function(){return delete wrapped.hook,delete wrapped.unhook,Object.defineProperties(wrapped,original_props),wrapped},enumerable:!1,configurable:!0}};return hookEventProp=function(ev){handlers[ev]={apply:function(ev,target,thisArg,argumentsList){var payload={event:ev,target:target};return payload[ev]={wrapped:wrapped,thisArg:thisArg,argumentsList:argumentsList,result:target.apply(wrapped,argumentsList)},events[ev].length?events[ev].forEach(function(fn){fn(payload)}):events.change.length?events.change.forEach(function(fn){fn(payload)}):console.log({event:payload}),payload[ev].result}.bind(this,ev)},original_props[ev]={value:wrapped[ev],enumerable:!1,configurable:!0},wrapped_props[ev]={value:new Proxy(original_props[ev].value,handlers[ev]),enumerable:!1,configurable:!0}},Object.keys(events).forEach(hookEventProp),events.change=[],Object.defineProperties(wrapped,wrapped_props),Object.defineProperties(wrapped,event_props),wrapped}),array.prototype("proxify",function(){return Array.proxifyArray(this)})}),extend(String,function(string){string.prototype("contains",function(s){return String.prototype.includes.call(this,s)});var getOutput=RegExp.split.getOutput;function wrapStringMethod(method,checkEmpty){string.prototype(method,function(needle,limit,map){return checkEmpty&&checkEmpty(needle)?null:String[method](this,needle,limit,map)})}function camelCaseWord(s,ix){return s=s.trim().toLowerCase(),0===ix?s:s.charAt(0).toUpperCase()+s.substr(1)}function camelCaseArray(a){return a.map(camelCaseWord).join("")}function makeTextToken(x){var t={text:x.text};return Object.defineProperties(t,{toString:{value:function(){return this.text},enumerable:!1,configurable:!0}}),t}function makeToken(x){var t={split:x.delimit,mode:x.mode};return x.groups&&(t.groups=x.groups),x.delimit_src&&(t.src=x.delimit_src),Object.defineProperties(t,{toString:{value:function(){return this.text||this.split},enumerable:!1,configurable:!0}}),t}function whiteOutComments(src,singleChar,multiChar){var out=[],number="number"===singleChar,num_prefix=multiChar||"",w1=number?" ":singleChar||" ",w2=number?" ":multiChar||" ",white1=!1===singleChar?function(){return""}:function(x){return new Array(x.length+1).join(w1)},white2=!1===multiChar?function(){return""}:function(x){return new Array(x.length+1).join(w2)},singleStart=" "===w1?"  ":"//",multiStart=" "===w2?"  ":"/*",multiEnd=" "===w2?"  ":"*/",lines=src.split("\n"),isMulti=lines.map(function(){return!1}),regex=/(?<=(\(|=|;|,|^)\s*)\/((?![*+?])(?:[^\r\n\[/\\]|\\.|\[(?:[^\r\n\]\\]|\\.)*\])+)\/((?:g(?:im?|mi?)?|i(?:gm?|mg?)?|m(?:gi?|ig?)?)?)/,escapes={escapedSingleQuote:/\\'/g,escapedDoubleQuote:/\\"/g,escapedNewLine:/\\\n/g},regexps={singleLine:/\/\//g,newLine:/\n/g,multiLineStart:/(?<!\/)\/\*/g,multiLineEnd:/\*\//g,singleQuote:/\'/g,doubleQuote:/\"/g},inMultiLineComment=!1;if(lines.forEach(function(line,ix){var OUT="",toks0=line.ArraySplit(regex),toks1=[],toks2=[];toks0?toks0.tokens.forEach(function(tok){if(tok.text){var sub=tok.text.ArraySplit(escapes);sub?sub.tokens.forEach(function(tok){toks2.push(tok)}):toks1.push(tok)}else toks1.push(tok)}):toks1=(toks1=line.ArraySplit(escapes))?toks1.tokens:[{text:line}],toks1.forEach(function(tok){if(tok.text){var sub=tok.text.ArraySplit(regexps);sub?sub.tokens.forEach(function(tok){toks2.push(tok)}):toks2.push(tok)}else toks2.push(tok)}),toks1=toks0=null;var inSingleLineComment=!1,inSingleQuote=!1,inDoubleQuote=!1;isMulti[ix]=inMultiLineComment,toks2.forEach(function(x){switch(!0){case inSingleLineComment:switch(x.src){case regex:case regexps.singleQuote:case regexps.doubleQuote:case escapes.escapedSingleQuote:case escapes.escapedDoubleQuote:case regexps.singleLine:case regexps.multiLineStart:case regexps.multiLineEnd:OUT+=white1(x.split);break;case escapes.escapedNewLine:OUT+=white1(" ")+"\n";break;case regexps.newLine:inSingleLineComment=!1,OUT+=x.split;break;default:x.text&&(OUT+=white1(x.text))}break;case inMultiLineComment:switch(x.src){case regex:case regexps.doubleQuote:case regexps.singleQuote:case escapes.escapedSingleQuote:case escapes.escapedDoubleQuote:case regexps.singleLine:case regexps.multiLineStart:OUT+=white2(x.split);break;case escapes.escapedNewLine:OUT+=white2(" ")+"\n";break;case regexps.multiLineEnd:OUT+=multiEnd,inMultiLineComment=!1;break;case regexps.newLine:OUT+=x.split;break;default:x.text&&(OUT+=white2(x.text))}break;case inSingleQuote:switch(x.src){case regex:case escapes.escapedSingleQuote:case escapes.escapedDoubleQuote:case regexps.singleLine:case regexps.multiLineStart:case regexps.multiLineEnd:case escapes.escapedNewLine:case regexps.doubleQuote:OUT+=x.split;break;case regexps.singleQuote:OUT+=x.split,inSingleQuote=!1;break;case regexps.newLine:throw new Error("unterminated string");default:x.text&&(OUT+=x.text)}break;case inDoubleQuote:switch(x.src){case regex:case escapes.escapedSingleQuote:case escapes.escapedDoubleQuote:case regexps.singleLine:case regexps.multiLineStart:case regexps.multiLineEnd:case escapes.escapedNewLine:case regexps.singleQuote:OUT+=x.split;break;case regexps.doubleQuote:OUT+=x.split,inDoubleQuote=!1;break;case regexps.newLine:throw new Error("unterminated string");default:x.text&&(OUT+=x.text)}break;default:if(x.text){OUT+=x.text;break}switch(x.src){case regexps.singleLine:OUT+=singleStart,inSingleLineComment=!0;break;case regexps.multiLineStart:OUT+=multiStart,inMultiLineComment=!0;break;case regexps.multiLineEnd:throw new Error(" OUT of place */");case regexps.singleQuote:inSingleQuote=!0,OUT+=x.split;break;case regexps.doubleQuote:inDoubleQuote=!0,OUT+=x.split;break;case regex:case regexps.newLine:OUT+=x.split}}}),out.push(OUT)}),lines.length!==out.length)throw new Error("internal error - out.length !== lines.length !");if(!1===singleChar&&!1===multiChar){function empty_lines(x){return 0<x.length}function collapse_line_ends(line,ix,ar){if(ix<ar.length-1){var next_line=ar[ix+1];(line.endsWith("=")||line.endsWith("{")||next_line.startsWith("}")||line.endsWith(";")&&!next_line.startsWith("function ")&&!next_line.startsWith("var "))&&(line+=next_line,ar[ix+1]="",fix_needed=!0)}return line}var fix_needed=!0;for(out=out.map(function(line){return line.trim()}).filter(empty_lines);fix_needed;)fix_needed=!1,out=out.map(collapse_line_ends).filter(empty_lines)}if(!number)return out.join("\n");var pad=2+(1+lines.length).toString().length;return lines.map(function(line,ix){return isMulti[ix]?" *"+num_prefix+(1+ix).toString().padStart(pad)+" *  "+line:"/*"+num_prefix+(1+ix).toString().padStart(pad)+" */ "+line}).join("\n")}function ArraySplitViaWhitespaceComments(code,needle,limit,map){var c255=String.fromCharCode(255),split=whiteOutComments(code,c255,c255).ArraySplit(needle,limit);if(!split)return split;function falseToNull(x,ix){return!1===x||limit&&limit-1<=ix?null:x}var tok_ix=0;return split.raw.forEach(function(x,ix){x.text=x.length?code.substr(x.start,x.length):"",split[ix]=map?map(x.text,ix,split,x.start,falseToNull(x.next,ix),falseToNull(x.delimit,ix)):x.text,0!==x.length&&(split.tokens[tok_ix++]=makeTextToken(x)),x.delimit&&(split.tokens[tok_ix++]=makeToken(x))}),split}string("StringSplit",function(haystack,needle,limit,map){if(isEmpty(needle)||!isString(needle))return null;var haystack_length=haystack.length,splits=String.split(haystack,needle,limit),splits_length=splits.length;if(!map||!splits)return splits&&splits[0].length!==haystack_length?splits:null;var output_push,output=getOutput(map,function(push){output_push=push});if(splits_length<=1)return output_push(splits[0],0,null,null),output;var atIndex=0;needle.length;return splits.forEach(function(text,ix){var tail=ix===splits.length-1?null:needle;output_push(text,atIndex,null===tail?null:atIndex+text.length+tail.length,tail),atIndex=atIndex+text.length+(null===tail?0:tail.length)}),splits.splice(0,splits.length),output}),wrapStringMethod("StringSplit"),string("toCamelCase",function(){return camelCaseArray(this.split(" "))}),string("customNeedleString",function(s,name,props){switch(jsClass(s)){case"String":var S=String;if(void 0!==(s="string"==typeof s?new S(s):s).__CustomSplit){if(s.__CustomSplit==name)return s;delete s.__CustomSplit}return(props=props||{}).__CustomSplit={value:camelCaseWord(name),enumerable:!1,configurable:!0},Object.defineProperties(s,props),s;case"Object":case"Array":return Array.flattenArray(s).map(function(e){return String.customNeedleString(e,name,props)});default:return s}}),string("makeTextToken",makeTextToken),string("makeToken",makeToken),string("ArraySplit",function(){var c,c2,m,m2,s,re,needleFunctionName=(s=Object.prototype.toString.call.bind(Object.prototype.toString),re=/(\[object)\s{1}/g,function(haystack,needle){return m=(c=s(haystack)).match(re),m2=(c2=s(needle)).match(re),m&&m2?camelCaseArray([c.substring(m[0].length,c.length-1),c2.substring(m2[0].length,c2.length-1),needle.__CustomSplit||""])+"Split":""}),splitters={stringRegexpSplit:stringRegexpSplit,stringStringSplit:function(haystack,needle,limit,map){var check_fn=needleFunctionName(haystack,needle);{if("stringStringSplit"===check_fn){if(0===needle.length)return null;haystack.length;var splits=haystack.split(needle,limit),splits_length=splits.length;if(splits_length<=1)return null;function remap(el,ix){return map(el.text,ix,out,el.start,el.next,ix<splits_length-1?needle:null,null)}function get_el_n(str_n,n,els){switch(n){case 0:return out.push(map?remap(el0,n):el0)}var str_n_len=str_n.length,str_n_end=el_n_minus_1.next+str_n_len,el_n={start:el_n_minus_1.next,end:str_n_end,length:str_n_len,text:str_n,prev:el_n_minus_1.start,next:n<splits_length-1&&str_n_end+needle_len,delimit:n<splits_length-1&&needle,delimit_length:n<splits_length-1&&needle_len,index:n,mode:"String"};el_n_minus_1=el_n,out.push(map?remap(el_n,n):el_n)}var out=[],needle_len=needle.length,str_0=splits[0],s0_len=str_0.length,el0={start:0,end:s0_len,length:s0_len,text:str_0,prev:!1,next:s0_len+needle_len,delimit:needle,delimit_length:needle_len,index:0,mode:"String"},el_n_minus_1=el0;return 2===splits_length?(map?out.push(remap(el0,0)):out.push(el0),get_el_n(splits[1],1)):splits.forEach(get_el_n),out}var msg="stringRegexpSplit called - should it not be "+check_fn+" ?";throw console.log(msg)}},stringArraySplit:stringArraySplit,stringObjectSplit:function(haystack,needles,limit,map){return ArraySplit(haystack,Array.flattenArray(needles),limit,map)},stringStringWordsearchSplit:function(haystack,needle,limit,map){var word=needle.toString(),customNeedle=RegExp("(?<![\\w\\d])"+word+"(?![\\w\\d])");return customNeedle.__CustomSplit="Wordsearch("+word+")",customNeedle.__CustomSplit_src=needle,stringRegexpSplit(haystack,customNeedle,limit)}};function stringRegexpSplit(haystack,needle,limit,map){var check_fn=needleFunctionName(haystack,needle);if(check_fn.startsWith("stringRegexp")){haystack.length;var mode=needle.__CustomSplit?needle.__CustomSplit:"RegExp",delimit_src=needle,splits=String.RegExpSplit(haystack,needle,limit,map||function(mode,text,index,theArray,start,end,delimit,match,strings){if(!1!==text)return function(text,index,theArray,start,end,delimit,mode){var at_start=0===index,prev=theArray[index-1],at_end=!delimit,text_length=text.length,text_start=at_end?at_start?0:prev.next:start;return{start:text_start,end:text_start+text_length,text:text,length:text_length,prev:!at_start&&prev.next,next:!at_end&&end,delimit:!at_end&&delimit,delimit_src:!at_end&&delimit_src,delimit_length:!at_end&&delimit.length,index:index,mode:mode}}(text,index,theArray,start,end,delimit,mode);if(0===theArray.length)return;var last=theArray[theArray.length-1];last.start===start&&strings&&strings.groups&&(last.groups=strings.groups)}.bind(this,mode));return splits[splits.length-1].next=!1,splits}var msg="stringRegexpSplit called - should it not be "+check_fn+" ?";throw console.log(msg)}function sortOnDelimitStart(lowest,highest){return lowest.delimit_start-highest.delimit_start}function checkOverlaps(inst1,ix1,ar){ar.forEach(function(inst2,ix2){if(ix2!==ix1){if(inst2.delimit_start>inst1.delimit_start){if(inst2.delimit_start<inst1.delimit_end)throw console.log({inst1:inst1,inst2:inst2}),new Error("overlapping split terms")}else if(inst2.delimit_end>inst1.delimit_start){if(inst2.delimit_start<inst1.delimit_start)throw console.log({inst1:inst1,inst2:inst2}),new Error("overlapping split terms")}else if(inst2.delimit_end<inst1.delimit_end&&inst2.delimit_end>inst1.delimit_start)throw console.log({inst1:inst1,inst2:inst2}),new Error("overlapping split terms");if(inst1!==inst2&&!1!==inst1.next&&!1!==inst2.next&&(!1!==inst1.delimit_start&&inst1.delimit_start===inst2.delimit_start||!1!==inst1.delimit_end&&inst1.delimit_end===inst2.delimit_end))throw console.log({inst1:inst1,inst2:inst2}),new Error("overlapping split terms")}})}function stringArraySplit(haystack,needles,limit,map){if(isString(haystack)&&"object"==typeof needles&&needles.constructor===Array){haystack.length;var needle_descs=needles.map(function(n){return result=(needle=n).toString(),needle.__CustomSplit?needle.__CustomSplit+"("+result+")":result;var needle,result});needles=needles.filter(function(ignore,ix){return needle_descs.indexOf(needle_descs[ix])===ix}),needle_descs.length,needles.length,needle_descs.splice(0,needle_descs.length);function remap(el,ix){return map(el.text,ix,out,el.start,el.next,el.delimit,null)}var splits=needles.map(function(needle){var fn=String.needleFunction(haystack,needle);return fn?fn.call(this,haystack,needle,limit):null}),out=[],work=splits.map(function(arr,ix){return null===arr?null:1===arr.length?null:{ix:ix,splits:arr}}).filter(function(x){return null!==x});if(0===work.length)return null;if(1===work.length)return map?work[0].splits.map(remap):work[0].splits;work=work.map(function(delim){return delim.start=delim.splits[0].start,delim.text=delim.splits[0].text,delim.delimit=delim.splits[0].delimit,delim.delimit_start=delim.splits[0].end,delim.delimit_end=delim.splits[0].next,delim.end=delim.splits[0].next,delim.splits.forEach(function(inst){inst.delimit_start=inst.end,inst.delimit_end=inst.next,Object.defineProperties(inst,{delim:{value:delim,enumerable:!1,configurable:!0}})}),delim});var pending=[];work.forEach(function(delim){delim.splits.forEach(function(inst){pending.push(inst)})}),pending.sort(sortOnDelimitStart),pending.forEach(checkOverlaps),(pending=pending.filter(function(inst,ix){return null!==inst&&!!inst.delimit&&(void 0===limit||ix<limit)})).forEach(function(inst,ix,ar){inst.start=0===ix?0:ar[ix-1].delimit_end,inst.end=ix<ar.length||inst.delimit_end===haystack.length?inst.delimit_start:haystack.length,inst.length=inst.end-inst.start,inst.text=haystack.substring(inst.start,inst.end),delete inst.index,delete inst.prev,delete inst.next,inst.index=ix,out.push(map?remap(inst,ix):inst)});var last=out[out.length-1];if(last.delimit_end<haystack.length&&(void 0===limit||out.length<limit)){var final={start:last.delimit_end,end:haystack.length,length:haystack.length-last.delimit_end,text:haystack.substring(last.delimit_end,haystack.length),delimit:!1,delimit_start:!1,delimit_end:!1,index:out.length};out.push(map?remap(final,out.length):final)}return out}return null}function ArraySplit(haystack,needles,limit,map){if(isEmpty(needles))return null;var tokens=[],flattened=Array.flattenArrayWithPaths(needles),flat=flattened.arr,raw=stringArraySplit(haystack,flat,limit);if(null===raw)return raw;function falseToNull(x,ix){return!1===x||limit&&limit-1<=ix?null:x}var out=[];raw.some(function(x,index){return 0!==x.length&&tokens.push(makeTextToken(x)),x.delimit&&tokens.push(makeToken(x)),out.push(map?map(x.text,index,out,x.start,falseToNull(x.next,index),falseToNull(x.delimit,index)):x.text),void 0!==limit&&index===limit-1});var td_cache;return Object.defineProperties(out,{all_needles:{enumerable:!1,configurable:!0,writable:!0,value:needles},needles:{enumerable:!1,configurable:!0,writable:!0,value:flat},raw:{enumerable:!1,configurable:!0,writable:!0,value:raw},tokens:{enumerable:!1,configurable:!0,writable:!0,value:tokens},token_distribution:{enumerable:!1,configurable:!0,get:function(){if(!td_cache){td_cache={},tokens.forEach(function(x,ix){if(x.split){var split=x.src?x.src.__CustomSplit?x.mode:x.mode+"("+x.src.toString()+")":x.mode+"("+x.split+")";td_cache[split]?td_cache[split].indexes.push(ix):flat.some(function(needle){if(!x.src)return td_cache[split]={split:x.split,indexes:[ix]},!0;if(x.src.__CustomSplit){if(needle.__CustomSplit+"("+needle+")"===x.src.__CustomSplit)return td_cache[split]={split:x.src,indexes:[ix],custom_data:x.src.__CustomSplit_src},!0}else if(needle===x.src)return td_cache[split]={split:x.src,indexes:[ix]},!0})}});var keys=Object.keys(td_cache);td_cache={splits:new Array(flat.length),named:td_cache,paths:{}},keys.forEach(function(k){var split=td_cache.named[k],src=split.custom_data||split.src||split.split,ix=flat.indexOf(src);if(split.path=flattened.paths[ix],split.indexes.forEach(function(tokIx){tokens[tokIx].path=split.path}),td_cache.splits[ix]=split,Array.setArrayPath(td_cache.paths,split.path,split),split.custom_data){var custom_data=split.split;split.split=src,split.custom_data=custom_data}}),td_cache.splits=td_cache.splits.filter(function(el){return null!==el})}return td_cache}}}),out}return string("needleFunction",function(haystack,needle){return splitters[needleFunctionName(haystack,needle)]}),string.prototype("toWordsearch",function(props){return String.customNeedleString(this+"","Wordsearch",props)}),string("Wordsearch",function(needle,props){return String.customNeedleString(needle,"Wordsearch",props)}),ArraySplit}()),string.prototype("ArraySplit",function(needle,limit,map){return String.ArraySplit(this,needle,limit,map)}),string("whiteOutComments",whiteOutComments),string.prototype("whiteOutComments",function(singleChar,multiChar){return whiteOutComments(this,singleChar,multiChar)}),string.prototype("@codeStripped",function(){return whiteOutComments(this,!1,!1)}),string.prototype("@codeSpaced",function(){return whiteOutComments(this)}),string.prototype("@codeNumbered",function(){return whiteOutComments(this,"number")}),string.prototype("ArraySplitCode",function(needle,limit,map){return ArraySplitViaWhitespaceComments(this,needle,limit,map)}),string("RegExpSplit",RegExp.split),wrapStringMethod("RegExpSplit"),string("mapSplit",function(haystack,needle,limit,map){if(isEmpty(needle))return null;var handler;if(String.needleFunction&&String.ArraySplit)return String.ArraySplit(haystack,[needle],limit,map);if(!handler&&(handler=String.split,map))switch(jsClass(needle)){case"RegExp":handler=RegExp.split;break;case"String":handler=String.StringSplit}return handler(haystack,needle,limit,map)}),wrapStringMethod("mapSplit",isEmpty),string.prototype("@lines",function(nl){return this.split(nl||"\n")}),string.prototype("indent",function(spaces,nl){switch(typeof spaces){case"string":break;case"number":spaces=Array(1+spaces).join(" ");break;default:spaces="    "}return nl=nl||"\n",this.split(nl).map(function(x){return spaces+x}).join(nl)}),string.prototype("indentLevel",function(lines,tabs,reindent){var i;if(lines){if(lines=this.lines,reindent)return lines.map(function(line){return line.indentLevel(!1,tabs,!0)}).join("\n");var min=this.indentLevel(!1,tabs);if(0<lines.length)for(i=1;i<lines.length;i++)0!==lines[i].trim().length&&(min=Math.min(min,lines[i].indentLevel(!1,tabs)));return min}var remain=(this.trimLeft||this.trimStart).bind(this)(),chars=this.length-remain.length;if(0===chars)return reindent?this:0;tabs=tabs||4;var indented=this.substr(0,chars);for(i=chars=0;i<indented.length;i++)switch(indented.charAt(i)){case"\t":chars+=tabs-chars%tabs;continue;case"\r":case"\n":return 0;default:chars++}return reindent?new Array(1+chars).join(" ")+remain:chars}),string.prototype("reindent",function(spaces,tabs,nl){var current=this.indentLevel(!0,tabs);if(current===spaces)return String(this);var filler=new Array(1+spaces).join(" ");return nl=nl||"\n",this.indentLevel(!0,tabs,!0).split(nl).map(function(line){return filler+line.substr(current)}).join(nl)}),string.prototype("load",function(filename){return fs.readFileSync(filename,"utf8")}),string("load",function(filename){return fs.readFileSync(filename,"utf8")}),string("extensionsTest",function(verbose){getSafeJson(testMappedSampleData()),getSafeJson(testMappedSampleData(!0));var array_call0,array_call1,array_call2,array_call3,ArrayMapSample=(array_call0=reparse({ar:[],ix:0,x:""}),array_call1=reparse({ar:[array_call0],ix:1,x:" quick brown "}),array_call2=reparse({ar:[array_call0,array_call1],ix:2,x:" jumps over "}),array_call3=reparse({ar:[array_call0,array_call1,array_call2],ix:3,x:" lazy "}),[array_call0,array_call1,array_call2,array_call3]),ArrayMapSampleJSON=getSafeJson(ArrayMapSample);function testNotFound(name,data){if(null===data)return verbose&&console.log("PASS: > "+name),!0;throw console.log("FAIL: > "+name),console.log({testBasic:{got:data,expected:null}}),new Error("test failed")}function testBasic(name,data){var sample=["one","two","three"],sample_json=getSafeJson(sample);if(data&&getSafeJson(data)===sample_json)return verbose&&console.log("PASS: > "+name),!0;throw console.log("FAIL: > "+name),console.log({testBasic:{got:data,expected:sample}}),new Error("test failed")}function testBasicLimit(name,data,limit){var sample=["one","two","three"].slice(0,limit),sample_json=getSafeJson(sample);if(data&&getSafeJson(data)===sample_json)return verbose&&console.log("PASS: > "+name),!0;throw console.log("FAIL: > "+name),console.log({testBasicLimit:{got:data,expected:sample,limit:limit}}),new Error("test failed")}function testWords(name,data){var WordsSample=[""," quick brown "," jumps over "," lazy "],WordsSampleJSON=getSafeJson(WordsSample);if(data&&getSafeJson(data)===WordsSampleJSON)return verbose&&console.log("PASS: > "+name),!0;throw console.log("FAIL: > "+name),console.dir({testWords:{got:data,expected:WordsSample}},{depth:null}),new Error("test failed")}function testMappedSampleData(){var src="one two three",ix1=src.indexOf("one"),ix2=src.indexOf("two"),ix3=src.indexOf("three"),row1=reparse(["one",0,[],ix1,ix1+3+1," "]),row2=reparse(["two",1,[row1],ix2,ix2+3+1," "]),row3=reparse(["three",2,[row1,row2],ix3,null,null]);return reparse([row1,row2,row3])}function testMapped2(name,sample,obj,fn,args,limit){var history=[],FN=obj[fn],cb=args.pop();args.push(function(){var cb_args=cpArgs(arguments);if(ix>sample.length)throw 0<history.length&&console.log({prev_:history}),console.log({extra:cb_args,callNo:ix,limit:limit}),new Error("too many calls to callback");if(getArrayJson(sample[ix])===getArrayJson(cb_args))return history.push(cb_args),ix++,cb.apply(this,cb_args);0<history.length&&history.forEach(function(h,ix){console.log({ix:ix,good:h})});throw console.log({ix:ix,got_____:cb_args}),console.log({ix:ix,expected:sample[ix]}),console.log({limit:limit}),new Error("incorrect args")});var ix=0;return limit&&limit<=sample.length&&(sample.splice(limit,sample.length),sample[limit-1][4]=null,sample[limit-1][5]=null),limit&&limit>sample.length&&(limit=sample.length),FN.apply(obj,args)}function mappedResult(){return reparse(cpArgs(arguments))}function mappedTextResult(x,ix,ar){return reparse({x:x,ix:ix,ar:ar})}function testArrayMap(name,data){var json=getArrayJson(data);if(json===ArrayMapSampleJSON)return verbose&&console.log("PASS: > "+name),!0;throw console.dir({testArrayMap:{got__raw:data,got_sort:JSON.parse(json),expected:ArrayMapSample,got_json:json,expt_json:ArrayMapSampleJSON}},{depth:null}),console.log("FAIL: > "+name),new Error("test failed")}function testTokensRejoin(name,source,data){if(null===data)return verbose&&console.log("PASS: > "+name+" (barely - data is null)"),!0;var rejoined=data.tokens.map(function(e){return e.split||e.text}).join("");if(rejoined===source)return verbose&&console.log("PASS: > "+name),!0;throw console.log("FAIL: > "+name),console.log({testTokensRejoin:{got:data,rejoined:rejoined,expected:source}}),new Error("test failed")}function StringTests(obj,objName,func,filter){var source="the quick brown fox jumps over the lazy dog",theObj=obj||source,objFunc=theObj[func];return objFunc=obj?objFunc.bind(theObj,source):objFunc.bind(source),function(obj,objName,func,objFunc,filter){testNotFound("notFound returns null:"+objName+"."+func+"(null)",objFunc(null)),testNotFound("notFound returns null:"+objName+"."+func+"(null- false positive)",objFunc.call(this+" null token",null)),testNotFound("notFound returns null:"+objName+"."+func+"(undefined)",objFunc()),testNotFound("notFound returns null:"+objName+"."+func+"(undefined - false positive)",objFunc.call(this+" was undefined.")),testNotFound("notFound returns null:"+objName+"."+func+"([])",objFunc([])),testNotFound("notFound returns null:"+objName+"."+func+"({})",objFunc({})),(!filter||0<=filter.indexOf("Array"))&&(testNotFound("notFound returns null:"+objName+"."+func+"(String,String)",objFunc(["pigs","fly"])),testNotFound("notFound returns null:"+objName+"."+func+"(RegExp,RegExp)",objFunc([/pigs/,/fly/])),testNotFound("notFound returns null:"+objName+"."+func+"(Wordsearch,Wordsearch)",objFunc([String.Wordsearch("pigs"),String.Wordsearch("fly")]))),(!filter||0<=filter.indexOf("String"))&&testNotFound("notFound returns null:"+objName+"."+func+"(Wordsearch([String,String]))",objFunc(String.Wordsearch(["pigs","fly"]))),(!filter||0<=filter.indexOf("Array"))&&(testNotFound("notFound returns null:"+objName+"."+func+"(String,RegExp,Wordsearch)",objFunc(["pigs",/fly/,String.Wordsearch("quickly")])),testWords(objName+"."+func+"([String,String,String])",objFunc(["the","fox","dog"])),testWords(objName+"."+func+"([RegExp,RegExp,RegExp])",objFunc([/the/,/fox/,/dog/])),testWords(objName+"."+func+"([Wordsearch,Wordsearch,Wordsearch])",objFunc([String.Wordsearch("the"),String.Wordsearch("fox"),String.Wordsearch("dog")])),testWords(objName+"."+func+"(WordsSearch([String,String,String]))",objFunc(String.Wordsearch(["the","fox","dog"]))),testWords(objName+"."+func+"([Wordsearch(String),String,RegExp])",objFunc([String.Wordsearch("the"),"fox",/dog/])),testWords(objName+"."+func+"([String,String,String,notfound])",objFunc(["the","fox","dog","extra"])),testWords(objName+"."+func+"([RegExp,RegExp,RegExp,notfound])",objFunc([/the/,/fox/,/dog/,/extra/])),testWords(objName+"."+func+"([Wordsearch,Wordsearch,Wordsearch,notfound])",objFunc([String.Wordsearch("the"),String.Wordsearch("fox"),String.Wordsearch("dog"),String.Wordsearch("extra")])),testWords(objName+"."+func+"(WordsSearch([String,String,String,notfound]))",objFunc(String.Wordsearch(["the","fox","dog","extra"]))),testWords(objName+"."+func+"([Wordsearch(String),String,RegExp,notfound])",objFunc([String.Wordsearch("the"),"fox",/dog/,"extra"]))),(!filter||0<=filter.indexOf("Array")||0<=filter.indexOf("Object"))&&testWords(objName+"."+func+"({assorted keys})",objFunc({stupidKey:"the",dumbKey:/fox/,crazyKey:["dog".toWordsearch()],missingKey:String.Wordsearch([{gone:"cat"}])})),(!filter||0<=filter.indexOf("Array"))&&(testArrayMap(objName+"."+func+"([String,String,String])",objFunc(["the","fox","dog"],void 0,mappedTextResult)),testArrayMap(objName+"."+func+"([RegExp,RegExp,RegExp])",objFunc([/the/,/fox/,/dog/],void 0,mappedTextResult)),testArrayMap(objName+"."+func+"([Wordsearch,Wordsearch,Wordsearch])",objFunc([String.Wordsearch("the"),String.Wordsearch("fox"),String.Wordsearch("dog")],void 0,mappedTextResult)),testArrayMap(objName+"."+func+"(WordsSearch([String,String,String]))",objFunc(String.Wordsearch(["the","fox","dog"]),void 0,mappedTextResult)),testArrayMap(objName+"."+func+"([Wordsearch(String),String,RegExp])",objFunc([String.Wordsearch("the"),"fox",/dog/],void 0,mappedTextResult)),testArrayMap(objName+"."+func+"([String,String,String,notfound])",objFunc(["the","fox","dog","extra"],void 0,mappedTextResult)),testArrayMap(objName+"."+func+"([RegExp,RegExp,RegExp,notfound])",objFunc([/the/,/fox/,/dog/,/extra/],void 0,mappedTextResult)),testArrayMap(objName+"."+func+"([Wordsearch,Wordsearch,Wordsearch,notfound])",objFunc([String.Wordsearch("the"),String.Wordsearch("fox"),String.Wordsearch("dog"),String.Wordsearch("extra")],void 0,mappedTextResult)),testArrayMap(objName+"."+func+"(WordsSearch([String,String,String,notfound]))",objFunc(String.Wordsearch(["the","fox","dog","extra"]),void 0,mappedTextResult)),testArrayMap(objName+"."+func+"([Wordsearch(String),String,RegExp,notfound])",objFunc([String.Wordsearch("the"),"fox",/dog/,"extra"],void 0,mappedTextResult))),(!filter||0<=filter.indexOf("Array")||0<=filter.indexOf("Object"))&&testArrayMap(objName+"."+func+"([asorted keys via testArrayMap ])",objFunc({stupidKey:"the",dumbKey:/fox/,crazyKey:["dog".toWordsearch()],missingKey:String.Wordsearch([{gone:"cat"}])},void 0,mappedTextResult))}.bind(source)(theObj,objName,func,objFunc,filter)}function getSafeJson(x){var cache=[],output=JSON.stringify(x,function(key,value){if("object"==typeof value&&null!==value){if(function(e){return"object"==typeof e&&e.constructor===Array&&"number"==typeof e.index&&"string"==typeof e.input}(value))return function(e){var r={exec:e.slice(0)};return Object.keys(e).filter(function(x,ix){return x!=ix.toString()}).forEach(function(k){r[k]=e[k]}),r}(value);if(-1!==cache.indexOf(value))return{circular:jsClass(value)};cache.push(value)}return value});return cache.splice(0,cache.length),output}function reparse(x){return JSON.parse(getSafeJson(x))}function sortKeys(db){switch(jsClass(db)){case"Array":return db.map(sortKeys);case"Object":var k=Object.keys(db);k.sort();var r={};return k.forEach(function(K){r[K]=sortKeys(db[K])}),r;default:return db}}function getArrayJson(A){return getSafeJson(sortKeys(A))}testBasic("String.split(String)","one two three".split(" ")),testBasicLimit("String.split(String,1)","one two three".split(" ",1),1),testBasicLimit("String.split(String,2)","one two three".split(" ",2),2),testBasic("String.split(String,3)","one two three".split(" ")),testBasic("String.split(String,99)","one two three".split(" ")),testBasic("String.split(RegExp)","one two three".split(/\s/)),testBasicLimit("String.split(RegExp,1)","one two three".split(/\s/,1),1),testBasicLimit("String.split(RegExp,2)","one two three".split(/\s/,2),2),testBasic("String.split(RegExp,3)","one two three".split(/\s/,3)),testBasic("String.split(RegExp,99)","one two three".split(/\s/,99)),testBasic("String.StringSplit(String)","one two three".StringSplit(" ")),testBasicLimit("String.StringSplit(RegExp,1)","one two three".StringSplit(" ",1),1),testBasicLimit("String.StringSplit(RegExp,2)","one two three".StringSplit(" ",2),2),testBasic("String.StringSplit(String)","one two three".StringSplit(" ",3)),testBasic("String.StringSplit(String)","one two three".StringSplit(" ",99)),testMapped2("String.StringSplit(String,map)",testMappedSampleData(),"one two three","StringSplit",[" ",void 0,mappedResult]),testMapped2("String.StringSplit(String,map, limit 1)",testMappedSampleData(),"one two three","StringSplit",[" ",1,mappedResult],1),testMapped2("String.StringSplit(String,map, limit 2)",testMappedSampleData(),"one two three","StringSplit",[" ",2,mappedResult],2),testMapped2("String.StringSplit(String,map, limit 99)",testMappedSampleData(),"one two three","StringSplit",[" ",99,mappedResult],99),testBasic("String.RegExpSplit(RegExp)","one two three".RegExpSplit(/\s/)),testBasicLimit("String.RegExpSplit(RegExp, limit 1)","one two three".RegExpSplit(/\s/,1),1),testBasicLimit("String.RegExpSplit(RegExp limit 2)","one two three".RegExpSplit(/\s/,2),2),testBasic("String.RegExpSplit(RegExp, limit 3)","one two three".RegExpSplit(/\s/,3)),testBasic("String.RegExpSplit(RegExp, limit 99)","one two three".RegExpSplit(/\s/,99)),testMapped2("String.RegExpSplit(RegExp,map)",testMappedSampleData(),"one two three","RegExpSplit",[/\s/,void 0,mappedResult]),testBasic("String.mapSplit(String)","one two three".mapSplit(" ")),testBasic("String.mapSplit(/\\s/)","one two three".mapSplit(/\s/)),testBasic("String.mapSplit([/\\s/])","one two three".mapSplit([/\s/])),testBasic("String.mapSplit([' '])","one two three".mapSplit([" "])),testMapped2("String.mapSplit(String,map)",testMappedSampleData(),"one two three","mapSplit",[" ",void 0,mappedResult]),testMapped2("String.mapSplit(String,map limit 1)",testMappedSampleData(),"one two three","mapSplit",[" ",1,mappedResult],1),testMapped2("String.mapSplit(String,map limit 2)",testMappedSampleData(),"one two three","mapSplit",[" ",2,mappedResult],2),testMapped2("String.mapSplit(String,map limit 3)",testMappedSampleData(),"one two three","mapSplit",[" ",3,mappedResult],3),testMapped2("String.mapSplit(String,map limit 99)",testMappedSampleData(),"one two three","mapSplit",[" ",99,mappedResult],99),testBasic("String.mapSplit(RegExp)","one two three".mapSplit(/\s/)),testMapped2("String.mapSplit(RegExp,map)",testMappedSampleData(),"one two three","mapSplit",[/\s/,void 0,mappedResult]),testNotFound("notFound returns null:ArraySplit(null)","i searched all around the world".ArraySplit(null)),testNotFound("notFound returns null:ArraySplit(null- false positive)","i searched all around the world for a null token".ArraySplit(null)),testNotFound("notFound returns null:ArraySplit(undefined)","i searched all around the world".ArraySplit()),testNotFound("notFound returns null:ArraySplit(undefined- false positive)","i searched all around the world for a an undefined item".ArraySplit()),testNotFound("notFound returns null:ArraySplit([])","i searched all around the world".ArraySplit([])),testNotFound("notFound returns null:ArraySplit({})","i searched all around the world".ArraySplit({})),testNotFound("notFound returns null:ArraySplit('')","i searched all around the world".ArraySplit("")),testNotFound("notFound returns null:ArraySplit('')","i searched all around the world".ArraySplit(["pigs","fly"])),testNotFound("notFound returns null:ArraySplit('')","i searched all around the world".ArraySplit("pigs")),testTokensRejoin("String.ArraySplit(Strings x 4 hits)","the quick brown fox jumps over the lazy dog",String.ArraySplit("the quick brown fox jumps over the lazy dog",["the","jumps","lazy","dog"])),testTokensRejoin("String.ArraySplit(Strings 4 misses)","the quick brown fox jumps over the lazy dog",String.ArraySplit("the quick brown fox jumps over the lazy dog",["jumper","jumping","lazier","wolf"])),testTokensRejoin("String.ArraySplit(Strings x 4 hits + 4 misses)","the quick brown fox jumps over the lazy dog",String.ArraySplit("the quick brown fox jumps over the lazy dog",["the","jumper","jumping","jumps","lazier","lazy","wolf","dog"])),StringTests(String,"String","ArraySplit"),StringTests(String,"String","mapSplit"),StringTests(!1,'"string literal"',"ArraySplit"),StringTests(!1,'"string literal"',"mapSplit"),StringTests(!1,'"string literal"',"StringSplit","String"),StringTests(!1,'"string literal"',"RegExpSplit","RegExp")})}),function(){if(void 0===JSON.stringify_dates&&Object.defineProperties(JSON,{stringify_dates:{value:function(obj,replacer,spaces){if(void 0===Date.prototype.toJSON)return JSON.stringify(obj,replacer,spaces);try{return Date.JSON_off(),JSON.stringify(obj,replacer,spaces)}finally{Date.JSON_on()}}}}),"function"==typeof Date.JSON_off)return;var restore_Date_prototype_toJSON="function"==typeof Date.prototype.toJSON&&{toJSON:{value:Date.prototype.toJSON,enumerable:!1,configurable:!0,writable:!0}};Object.defineProperties(Date,{JSON_off:{enumerable:!1,configurable:!0,writable:!0,value:function(){restore_Date_prototype_toJSON&&delete Date.prototype.toJSON}},JSON_on:{enumerable:!1,configurable:!0,writable:!0,value:function(){restore_Date_prototype_toJSON&&Object.defineProperties(Date.prototype,restore_Date_prototype_toJSON)}}})}()},!!Object.env&&Object.env.isNode||!!Object.polyfills||"object"==typeof process&&"object"==typeof module&&"function"==typeof require&&!!require("./polyfills.min.js"));
/* jshint ignore:end */
